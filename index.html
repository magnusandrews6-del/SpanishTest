<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta charset="UTF-8">
<title>Spanish Conjugation Trainer</title>
<style>
  body {
    font-family: Arial;
    padding: 10px;
    max-width: 600px;
    margin: auto;
    -webkit-text-size-adjust: 100%;
    color: #FFFFFF; 
    background-color: #151B45;
  }

  input {
    padding: 10px;
    font-size: 18px;
    width: 100%;
    box-sizing: border-box;
  }

  button {
    padding: 10px 20px;
    font-size: 18px;
    margin-top: 10px;
  }

  #feedback {
    margin-top: 10px;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>Spanish Conjugation Trainer</h1>
<p id="prompt"></p>
<input id="answer" type="text" autocomplete="off">
<button onclick="checkAnswer()">Submit</button>
<p id="feedback"></p>

<script>
// --- Data ---
const verbs = [
  { infinitive: "hablar", type: "ar", english: "speak" },
  { infinitive: "comer", type: "er", english: "eat" },
  { infinitive: "vivir", type: "ir", english: "live" },
  { infinitive: "ir", type: "ir", english: "go" },
  { infinitive: "ser", type: "ir", english: "be" },
  { infinitive: "ver", type: "er", english: "see" },
  { infinitive: "tener", type: "er", english: "have" },
  { infinitive: "hacer", type: "er", english: "do/make" },
  { infinitive: "venir", type: "ir", english: "come" },
  { infinitive: "decir", type: "ir", english: "say/tell" }
];

const tenses = {
  present: {
    endings: { ar:["o","as","a","amos","√°is","an"], er:["o","es","e","emos","√©is","en"], ir:["o","es","e","imos","√≠s","en"] },
    irregulars: {
      ir:["voy","vas","va","vamos","vais","van"],
      ser:["soy","eres","es","somos","sois","son"],
      ver:["veo","ves","ve","vemos","veis","ven"],
      tener:["tengo","tienes","tiene","tenemos","ten√©is","tienen"],
      hacer:["hago","haces","hace","hacemos","hac√©is","hacen"],
      venir:["vengo","vienes","viene","venimos","ven√≠s","vienen"],
      decir:["digo","dices","dice","decimos","dec√≠s","dicen"]
    }
  },
  imperfect: {
    endings: { ar:["aba","abas","aba","√°bamos","abais","aban"], er:["√≠a","√≠as","√≠a","√≠amos","√≠ais","√≠an"], ir:["√≠a","√≠as","√≠a","√≠amos","√≠ais","√≠an"] },
    irregulars: {
      ir:["iba","ibas","iba","√≠bamos","ibais","iban"],
      ser:["era","eras","era","√©ramos","erais","eran"],
      ver:["ve√≠a","ve√≠as","ve√≠a","ve√≠amos","ve√≠ais","ve√≠an"]
    }
  },
  preterite: {
    endings: { ar:["√©","aste","√≥","amos","asteis","aron"], er:["√≠","iste","i√≥","imos","isteis","ieron"], ir:["√≠","iste","i√≥","imos","isteis","ieron"] },
    irregulars: {
      ir:["fui","fuiste","fue","fuimos","fuisteis","fueron"],
      ser:["fui","fuiste","fue","fuimos","fuisteis","fueron"],
      ver:["vi","viste","vio","vimos","visteis","vieron"],
      tener:["tuve","tuviste","tuvo","tuvimos","tuvisteis","tuvieron"],
      hacer:["hice","hiciste","hizo","hicimos","hicisteis","hicieron"],
      venir:["vine","viniste","vino","vinimos","vinisteis","vinieron"],
      decir:["dije","dijiste","dijo","dijimos","dijisteis","dijeron"]
    }
  }
};

const pronouns = [
  { spanish:"yo", english:"I" },
  { spanish:"t√∫", english:"You (sing.)" },
  { spanish:"√©l/ella", english:"He/She" },
  { spanish:"nosotros", english:"We" },
  { spanish:"vosotros", english:"You (pl.)" },
  { spanish:"ellos", english:"They" }
];

// --- English conjugations ---
const englishTenses = {
  hablar: { present:["speak","speak","speaks","speak","speak","speak"], imperfect:["was speaking","were speaking","was speaking","were speaking","were speaking","were speaking"], preterite:["spoke","spoke","spoke","spoke","spoke","spoke"] },
  comer: { present:["eat","eat","eats","eat","eat","eat"], imperfect:["was eating","were eating","was eating","were eating","were eating","were eating"], preterite:["ate","ate","ate","ate","ate","ate"] },
  vivir: { present:["live","live","lives","live","live","live"], imperfect:["was living","were living","was living","were living","were living","were living"], preterite:["lived","lived","lived","lived","lived","lived"] },
  ir: { present:["go","go","goes","go","go","go"], imperfect:["was going","were going","was going","were going","were going","were going"], preterite:["went","went","went","went","went","went"] },
  ser: { present:["am","are","is","are","are","are"], imperfect:["was","were","was","were","were","were"], preterite:["was","were","was","were","were","were"] },
  ver: { present:["see","see","sees","see","see","see"], imperfect:["was seeing","were seeing","was seeing","were seeing","were seeing","were seeing"], preterite:["saw","saw","saw","saw","saw","saw"] },
  tener: { present:["have","have","has","have","have","have"], imperfect:["had","had","had","had","had","had"], preterite:["had","had","had","had","had","had"] },
  hacer: { present:["do","do","does","do","do","do"], imperfect:["was doing","were doing","was doing","were doing","were doing","were doing"], preterite:["did","did","did","did","did","did"] },
  venir: { present:["come","come","comes","come","come","come"], imperfect:["was coming","were coming","was coming","were coming","were coming","were coming"], preterite:["came","came","came","came","came","came"] },
  decir: { present:["say","say","says","say","say","say"], imperfect:["was saying","were saying","was saying","were saying","were saying","were saying"], preterite:["said","said","said","said","said","said"] }
};

// --- Utilities ---
function randomItem(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function removeAccents(str){ return str.normalize("NFD").replace(/[\u0300-\u036f]/g,""); }

// --- Conjugation ---
function conjugate(verb, tenseName, personIndex){
  const tense = tenses[tenseName];
  if(tense.irregulars[verb.infinitive]) return tense.irregulars[verb.infinitive][personIndex];
  const stem = verb.infinitive.slice(0,-2);
  return stem + tense.endings[verb.type][personIndex];
}

// --- Session variables ---
let currentQuestion = null;
let sessionCorrect = 0;
let sessionCount = 0;
const sessionTotal = 20;

// --- Generate question ---
function newQuestion(){
  if(sessionCount >= sessionTotal){
    document.getElementById("prompt").innerText = "üéâ Session finished!";
    document.getElementById("answer").style.display = "none";
    document.querySelector("button").style.display = "none";
    document.getElementById("feedback").innerText += ` Final score: ${sessionCorrect}/${sessionTotal}`;
    return;
  }

  const verb = randomItem(verbs);
  const tenseName = randomItem(Object.keys(tenses));
  const personIndex = Math.floor(Math.random()*pronouns.length);
  const pronoun = pronouns[personIndex];

  const english = pronoun.english + " " + englishTenses[verb.infinitive][tenseName][personIndex];
  const correctAnswer = conjugate(verb, tenseName, personIndex);

  currentQuestion = { verb, tenseName, personIndex, correctAnswer };
  document.getElementById("prompt").innerText = english;
  document.getElementById("answer").value = "";
  document.getElementById("feedback").innerText = "";
}

// --- Check answer ---
function checkAnswer(){
  const input = document.getElementById("answer").value.trim().toLowerCase();
  const tokens = input.split(/\s+/);
  const userVerb = tokens[tokens.length-1];
  const normalizedUserVerb = removeAccents(userVerb);
  const normalizedCorrect = removeAccents(currentQuestion.correctAnswer);

  sessionCount++;

  if(normalizedUserVerb === normalizedCorrect){
    sessionCorrect++;
    document.getElementById("feedback").innerText = `‚úÖ Correct! (${sessionCorrect}/${sessionCount})`;
  } else {
    document.getElementById("feedback").innerText = `‚ùå Incorrect. Correct: ${currentQuestion.correctAnswer} (${sessionCorrect}/${sessionCount})`;
  }

  setTimeout(newQuestion, 1500);
}

// --- Enter key support ---
document.getElementById("answer").addEventListener("keydown", function(event){
  if(event.key === "Enter") checkAnswer();
});

// --- Start ---
newQuestion();
</script>

</body>
</html>


